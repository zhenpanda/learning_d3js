<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Stock D3</title>
	<link rel="stylesheet" href="main.css">
	<script  type="text/javascript" src="d3.min.js"></script>
</head>
<body>
<!--Place all DOM elements here -->
<script>
let data = {
  "bboList": [
    {
      "ask": 235400,
      "bid": 231800,
      "timeStr": "09:30:00.000"
    },
    {
      "ask": 235400,
      "bid": 230900,
      "timeStr": "09:30:07.819"
    },
    {
      "ask": 238300,
      "bid": 230900,
      "timeStr": "09:30:07.819"
    },
    {
      "ask": 238300,
      "bid": 227500,
      "timeStr": "09:30:26.786"
    },
    {
      "ask": 239900,
      "bid": 227500,
      "timeStr": "09:30:26.786"
    }
  ],
  "tradeList": [
    {
      "time": 34574353918784,
      "price": 233200,
      "shares": 100,
      "tradeType": "E",
      "orderReferenceNumber": 13983473
    },
    {
      "time": 34586652937952,
      "price": 233200,
      "shares": 100,
      "tradeType": "E",
      "orderReferenceNumber": 13983473
    },
    {
      "time": 34591808534547,
      "price": 233200,
      "shares": 100,
      "tradeType": "E",
      "orderReferenceNumber": 13983473
    },
    {
      "time": 34591808534547,
      "price": 233200,
      "shares": 200,
      "tradeType": "E",
      "orderReferenceNumber": 14109397
    },
    {
      "time": 34591808684978,
      "price": 233200,
      "shares": 100,
      "tradeType": "E",
      "orderReferenceNumber": 14301933
    }
  ]
}
//
// var data = [
// 	{key: "Jelly", value: 60, date: "2014/01/01" },
// 	{key: "Jelly", value: 58, date: "2014/01/02" },
// 	{key: "Jelly", value: 59, date: "2014/01/03" },
// 	{key: "Jelly", value: 56, date: "2014/01/04" },
// 	{key: "Jelly", value: 57, date: "2014/01/05" },
// 	{key: "Jelly", value: 55, date: "2014/01/06" },
// 	{key: "Jelly", value: 56, date: "2014/01/07" },
// 	{key: "Jelly", value: 52, date: "2014/01/08" },
// 	{key: "Jelly", value: 54, date: "2014/01/09" },
// 	{key: "Jelly", value: 57, date: "2014/01/10" },
// 	{key: "Jelly", value: 56, date: "2014/01/11" },
// 	{key: "Jelly", value: 59, date: "2014/01/12" },
// 	{key: "Jelly", value: 56, date: "2014/01/13" },
// 	{key: "Jelly", value: 52, date: "2014/01/14" },
// 	{key: "Jelly", value: 48, date: "2014/01/15" },
// 	{key: "Jelly", value: 47, date: "2014/01/16" },
// 	{key: "Jelly", value: 48, date: "2014/01/17" },
// 	{key: "Jelly", value: 45, date: "2014/01/18" },
// 	{key: "Jelly", value: 43, date: "2014/01/19" },
// 	{key: "Jelly", value: 41, date: "2014/01/20" },
// 	{key: "Jelly", value: 37, date: "2014/01/21" },
// 	{key: "Jelly", value: 36, date: "2014/01/22" },
// 	{key: "Jelly", value: 39, date: "2014/01/23" },
// 	{key: "Jelly", value: 41, date: "2014/01/24" },
// 	{key: "Jelly", value: 42, date: "2014/01/25" },
// 	{key: "Jelly", value: 40, date: "2014/01/26" },
// 	{key: "Jelly", value: 43, date: "2014/01/27" },
// 	{key: "Jelly", value: 41, date: "2014/01/28" },
// 	{key: "Jelly", value: 39, date: "2014/01/29" },
// 	{key: "Jelly", value: 40, date: "2014/01/30" },
// 	{key: "Jelly", value: 39, date: "2014/01/31" }
// ];

// // "09:30:26.786"
// var hms = '09:30:26.786';   // your input string
// var a = hms.split(':'); // split it at the colons
// // minutes are worth 60 seconds. Hours are worth 60 minutes.
// console.log(a);

// convert time to millisonseconds
function convertTime(timeStr) {
	let timeParts = timeStr.split(':');
	let time = 0;
	for (let p=0; p<timeParts.length; p++) {
		if (p===0) time+= parseInt(timeParts[p])*60*60;
		else if (p===1) time+= parseInt(timeParts[p])*60;
		else if (p===2) time+= parseInt(timeParts[p]);
	};
	console.log(time/1000);
	return time/1000;
}
// let d1 = convertTime('09:30:00.000');
// let d2 = convertTime('09:30:26.786');


function parseJson(json) {
	// var data = [ {key: "Jelly", value: 60, date: "2014/01/01" } ];

}


// var data2 = [
// 	{key: "", value: 23.8300, date: d1 },
// 	{key: "", value: 23.9900, date: d2 }
// ];

var w = 800;
var h = 450;

var margin = {
	top: 80,
	bottom: 100,
	left: 80,
	right: 40
};
var width = w - margin.left - margin.right;
var height = h - margin.top - margin.bottom;

var svg = d3.select("body").append("svg")
			.attr("id", "chart")
			.attr("width", w)
			.attr("height", h);
var chart = svg.append("g")
			.classed("display", true)
			.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var dateParser = d3.time.format("%Y/%m/%d").parse;
//
// console.log("2014/01/31");
// console.log(dateParser("2014/01/31"));
var x = d3.time.scale()
				  .domain(d3.extent(data), (d)=>{return d.date})
					.range([0, width]);
var y = d3.scale.linear()
	        .domain([0,d3.max(data,(d)=>{return d.value})])
					.range([height,0]);

function plot(params) {
	console.log(params.data);
	// enter
	this.selectAll(".point")
		  .data(params.data)
			.enter()
			.append("circle")
			.classed("point", true)
			.attr("r",2)
	// update
	this.selectAll(".point")
	    .attr("cx", (d)=>{return d.date})
			.attr("cy", (d)=>{return d.value})
	this.selectAll(".point")
			.data(params.data)
			.exit()
			.remove()
}
plot.call(chart, {data:data2});

</script>
</body>
</html>
